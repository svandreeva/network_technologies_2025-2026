---
## Front matter
lang: ru-RU
title: "Лабораторная работа №6" 
subtitle: "Сетевые технологии"
author:
  - Андреева С.В.
institute:
  - Группа НПИбд-01-23
  - Российский университет дружбы народов, Москва, Россия

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 - '\makeatletter'
 - '\beamer@ignorenonframefalse'
 - '\makeatother'

## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
---

# Информация

## Докладчик

:::::::::::::: {.columns align=center}
::: {.column width="70%"}

  * Андреева Софья Владимировна
  * Группа НПИбд-01-23
  * Российский университет дружбы народов


:::
::: {.column width="30%"}


:::
::::::::::::::

# Вводная часть

# Цель работы

Целью данной работы является изучение принципов распределения и настройки адресного пространства на
устройствах сети.

## Разбиение сети на подсети

**Сеть 172.16.20.0/24**

Характеристики исходной сети:
1. **Префикс**: /24
2. **Маска**: 
   - Двоичный вид: `11111111.11111111.11111111.00000000`
   - Десятичный вид: `255.255.255.0`
3. **Адрес сети**: `172.16.20.0`
4. **Broadcast-адрес**: `172.16.20.255`
5. **Общее число адресов**: 256
6. **Число доступных адресов для хостов**: 254
7. **Диапазон адресов узлов**: `172.16.20.1 — 172.16.20.254`

## Разбиение на 3 подсети (требования: 126, 62, 62 узлов)
Используем VLSM, начиная с наибольшего требования:
- **Для 126 узлов**: требуется 7 хостовых бит (2⁷ - 2 = 126) , значит префикс /25
- **Для 62 узлов**: требуется 6 хостовых бит (2⁶ - 2 = 62) , значит префикс /26
**Разделение:**
1. **Первый блок (/25)**:
   - Сеть: `172.16.20.0/25`
   - Маска: `255.255.255.128`
   - Broadcast: `172.16.20.127`
   - Диапазон адресов узлов : `172.16.20.1 — 172.16.20.126`

## Разбиение на 3 подсети (требования: 126, 62, 62 узлов)

2. **Второй блок (/26)**:
   - Сеть: `172.16.20.128/26`
   - Маска: `255.255.255.192`
   - Broadcast: `172.16.20.191`
   - Диапазон адресов узлов: `172.16.20.129 — 172.16.20.190`

3. **Третий блок (/26)**:
   - Сеть: `172.16.20.192/26`
   - Маска: `255.255.255.192`
   - Broadcast: `172.16.20.255`
   - Диапазон адресов узлов: `172.16.20.193 — 172.16.20.254`

## Разбиение сети на подсети

**Сеть 10.10.1.64/26**

Характеристики:
1. **Префикс**: /26
2. **Маска**: `255.255.255.192`
3. **Адрес сети**: `10.10.1.64`
4. **Broadcast**: `10.10.1.127`
5. **Общее число адресов**: 64
6. **Доступных для хостов**: 62
7. **Диапазон узлов**: `10.10.1.65 — 10.10.1.126`

## Выделение подсети на 30 узлов
- Требуется 5 хостовых бит (2⁵ - 2 = 30) , значит префикс /27
- Выделенная подсеть: `10.10.1.64/27`
- Маска: `255.255.255.224`
- Broadcast: `10.10.1.95`
- Диапазон адресов узлов: `10.10.1.65 — 10.10.1.94`

## Разбиение сети на подсети

**Сеть 10.10.1.0/26**

Характеристики:
1. **Префикс**: /26
2. **Маска**: `255.255.255.192`
3. **Адрес сети**: `10.10.1.0`
4. **Broadcast**: `10.10.1.63`
5. **Общее число адресов**: 64
6. **Доступных для хостов**: 62
7. **Диапазон узлов**: `10.10.1.1 — 10.10.1.62`

## Выделение подсети на 14 узлов

- Требуется 4 хостовых бит (2⁴ - 2 = 14) , значит префикс /28
- Выделенная подсеть: `10.10.1.0/28`
- Маска: `255.255.255.240`
- Broadcast: `10.10.1.15`
- Диапазон адресов узлов: `10.10.1.1 — 10.10.1.14`

## Разбиение IPv6-сети на подсети

**Сеть 2001:db8:c0de::/48**
Характеристики:
1. **Префикс**: /48
2. **Маска**: `ffff:ffff:ffff:0000:0000:0000:0000:0000`
3. **Структура**:
   - Биты 0-47: глобальный префикс `2001:0db8:c0de`
   - Биты 48-63: идентификатор подсети
   - Биты 64-127: идентификатор интерфейса
4. **Диапазон адресов**:
   - Минимальный: `2001:db8:c0de:0000:0000:0000:0000:0000`
   - Максимальный: `2001:db8:c0de:ffff:ffff:ffff:ffff:ffff`
5. **Число адресов**: 2⁸⁰

## Разбиение на 2 подсети
**С использованием идентификатора подсети**

Берём 1 бит из 16-битного Subnet ID, увеличиваем префикс с /48 до /49. Это даёт 2 подсети, каждая размером /49.

- **Подсеть 0**: `2001:db8:c0de:0000::/49`
  - Диапазон: `2001:db8:c0de:0000:0000:0000:0000:0000 — 2001:db8:c0de:7fff:ffff:ffff:ffff:ffff`
- **Подсеть 1**: `2001:db8:c0de:8000::/49`
  - Диапазон: `2001:db8:c0de:8000:0000:0000:0000:0000 — 2001:db8:c0de:ffff:ffff:ffff:ffff:ffff`

## Разбиение на 2 подсети

**Использование идентификатора интерфейса**

При данном подходе мы берём 1 бит не из Subnet ID, а из Interface ID (последних 64 бит). 

**Механизм разделения:**
- Оставляем SubnetID на фиксированном значении (например 0)
- Делим пространство адресов по старшему биту интерфейсного поля
- Увеличиваем префикс от /48 до /65
  - *Расчёт:* 48 + 17 = 65 (16 бит из Subnet ID + 1 бит из IID)

**Созданные подсети:**

**Подсеть A:** `2001:db8:c0de:0::/65`
- **Диапазон:** от `2001:db8:c0de:0000:0000:0000:0000:0000` до `2001:db8:c0de:0000:7fff:ffff:ffff:ffff`
- **Условие:** IID старший бит = 0

## Разбиение на 2 подсети

**Подсеть B:** `2001:db8:c0de:0:8000::/65`
- **Диапазон:** от `2001:db8:c0de:0000:8000:0000:0000:0000` до `2001:db8:c0de:0000:ffff:ffff:ffff:ffff`
- **Условие:** IID старший бит = 1

Такой подход является **нестандартным**!  
Обычно интерфейсный идентификатор — это область размером 64 бита, которую не рекомендуется изменять. Использование префиксов длиннее /64 для реальных LAN приводит к проблемам с:
- SLAAC 
- Некорректной работой сетевых реализаций
- Нарушением стандартов RFC

## Разбиение на 2 подсети

**Сеть 2a02:6b8::/64**
Характеристики:
1. **Префикс**: /64
2. **Маска**: `ffff:ffff:ffff:ffff:0000:0000:0000:0000`
3. **Диапазон адресов**:
   - Минимальный: `2a02:06b8:0000:0000:0000:0000:0000:0000`
   - Максимальный: `2a02:06b8:0000:0000:ffff:ffff:ffff:ffff`
4. **Число адресов**: 2⁶⁴

## Разбиение на 2 подсети

**Разбиение на 2 подсети с использованием идентификатора подсети:**

При префиксе /64 под подсети уже не отведено битов, так как первые 64 бита — это префикс сети. Поэтому для деления нам придется нарушить стандарт и заимствовать биты из идентификатора интерфейса. 

**С использованием идентификатора интерфейса** (префикс /65):
- **Подсеть 1**: `2a02:6b8::/65`
  - Диапазон: `2a02:6b8:: — 2a02:6b8::7fff:ffff:ffff:ffff`
- **Подсеть 2**: `2a02:6b8::8000:0:0:0/65`
  - Диапазон: `2a02:6b8::8000:0:0:0 — 2a02:6b8::ffff:ffff:ffff:ffff`

## Настройка двойного стека адресации IPv4 и IPv6 в локальной сети

Запустили GNS3 VM и GNS3. Создали новый проект.

## Выполнение работы

![Создание нового проекта в GNS3 ](image/1.png){#fig-001 width=70%}

## Выполнение работы

В рабочем пространстве разместили и соединили устройства в соответствии с топологией, приведённой в лабораторной работе. Для подсети IPv4 использовали маршрутизатор FRR, а для подсети с IPv6 — маршрутизатор VyOS.  Коммутаторам присвойте названия по принципу msk-svandreeva -sw-0x, маршрутизаторам — по принципу msk-svandreeva -gw-0x, VPCS — по принципу PCx-svandreeva , где x — порядковый номер устройства 

## Выполнение работы

![Топология сети с двумя локальными подсетями](image/2.png){#fig-002 width=70%}

## Выполнение работы

Включили захват трафика на соединении между сервером двойного стека адресации и ближайшим к нему коммутатором 

![Захват трафика на соединении между сервером двойного стека адресации и ближайшим к нему коммутатором](image/3.png){#fig-003 width=60%}

## Выполнение работы

Руководствуясь (табл. 3.6), настроили IPv4-адресацию для интерфейсов узлов PC1, PC2, Server:
- PC1 :

![Настройка IP-адреса на PC1](image/4.png){#fig-004 width=70%}

## Выполнение работы

- PC2:

![Настройка IP-адреса на PC2](image/5.png){#fig-005 width=70%}

## Выполнение работы

- Server:

![Настройка IP-адреса на Server](image/6.png){#fig-006 width=70%}

## Выполнение работы

Посмотрели на PC1 и PC2 конфигурацию IPv4 и IPv6:

![Конфигурация IPv4 и IPv6](image/7.png){#fig-007 width=70%}

## Выполнение работы

Руководствуясь (табл. 3.6), настроили IPv4-адресацию для интерфейсов локальной сети маршрутизатора FRR msk-svandreeva -gw-01 :

## Выполнение работы

![Настройка IP-адреса на маршрутизаторе FRR](image/8.png){#fig-008 width=65%}

## Выполнение работы

Проверили конфигурацию маршрутизатора и настройки IPv4-адресации:

```
msk-svandreeva -gw-01# show running-config
msk-svandreeva -gw-01# show interface brief
```
## Выполнение работы

![Проверка конфигурации маршрутизатора FRR, настройки IPv4-адресации на маршрутизаторе FRR](image/9.png){#fig-009 width=70%}

## Выполнение работы

Далее проверили подключение с помощью команд ping и trace. Узлы PC1 и PC2 успешно отправляют эхо-запросы друг другу и на сервер с двойным стеком (Dual Stack Server) 

## Выполнение работы

![Отправка эхо-запросов между PC1 и PC2 и Server с помощью ping и trace](image/10.png){#fig-010 width=70%}

## Выполнение работы

Руководствуясь (табл. 3.6), настроили IPv6-адресацию для интерфейсов узлов PC3, PC4, Server:
- PC3:

![Настройка IP-адреса на PC3](image/11.png){#fig-011 width=70%}

## Выполнение работы

- PC4 :

![Настройка IP-адреса на PC4](image/12.png){#fig-012 width=70%}

## Выполнение работы

- Server:

![Настройка IP-адреса на Server](image/13.png){#fig-013 width=70%}

## Выполнение работы

Посмотрели на PC3 и PC4 конфигурацию IPv4 и IPv6 :

![Конфигурация IPv4 и IPv6 на PC3](image/14.png){#fig-014 width=60%}

## Выполнение работы

Руководствуясь (табл. 3.6), настроили IPv6-адресацию для интерфейсов локальной сети маршрутизатора VyOS msk-svandreeva -gw-02.Перешли в режим конфигурирования, изменили имя устройства:

![Настройка имени устройства ](image/15.png){#fig-015 width=60%}

## Выполнение работы

- Назначили IPv6-адреса маршрутизатору msk-svandreeva -gw-02 :

![Настройка на маршрутизаторе VyOS ](image/16.png){#fig-016 width=60%}

## Выполнение работы

![Сохранение и Проверка настроек IPv6-адресации на маршрутизаторе VyOS](image/17.png){#fig-017 width=60%}

## Выполнение работы

Проверили подключение с помощью команд ping и trace. Узлы PC3 и PC4 успешно отправляют эхо-запросы друг другу и на сервер с двойным стеком (Dual Stack Server) 

## Выполнение работы

![Отправка эхо-запросов  PC3, PC4 и Server с помощью ping и trace](image/18.png){#fig-018 width=60%}

## Выполнение работы

Убедились, что устройства из подсети IPv4 не доступны для устройств из подсети IPv6 и наоборот. Только сервер двойного стека может обращаться к устройствам обеих подсетей 

## Выполнение работы

![Попытка подключения  PC3, PC4 к PC1, PC2](image/19.png){#fig-019 width=70%}

## Выполнение работы

![Попытка подключения PC1 к PC3](image/20.png){#fig-020 width=70%}

## Выполнение работы

Далее посмотрели захваченный на соединении сервера двойного стека адресации с коммутатором трафик ARP, ICMP, ICMPv6. Сеть работоспособна - есть двусторонняя связь, оба стека (IPv4/IPv6) активны, базовые протоколы работают корректно 

## Выполнение работы

![Перехваченные пакеты ICMPv6](image/21.png){#fig-021 width=70%}

## Выполнение работы

![Перехваченные пакеты ICMP](image/22.png){#fig-022 width=70%}

## Выполнение работы

![Перехваченные пакеты ARP](image/23.png){#fig-023 width=70%}

## Задание для самостоятельного выполнения

Создали новый проект.Задали топологию сети 

![Топология сети с двумя локальными подсетями ](image/24.png){#fig-024 width=60%}

## Выполнение работы

Предполагается, что маршрутизатор разбивает сеть на две подсети с адресами IPv4 и IPv6:

- подсеть 1: 10.10.1.96/27; 2001:DB8:1:1::/64;
- подсеть 2: 10.10.1.16/28; 2001:DB8:1:4::/64.

Охарактеризовали подсети, укажем, какие адреса в них входят.Предложили вариант таблицы адресации для заданной топологии и адресного пространства

## Выполнение работы

![Таблица](image/25.png){#fig-025 width=70%}

## Выполнение работы

Задали IP-адреса для PC1

![Настройка IP-адреса на PC1-svandreeva ](image/26.png){#fig-026 width=60%}

## Выполнение работы

Задали IP-адреса для PC2 

![Настройка IP-адреса на PC2-svandreeva ](image/27.png){#fig-027 width=70%}

## Выполнение работы

Назначили IPv6 и IPv4-адреса интерфейсам маршрутизатора msk-svandreeva -gw-01 :

## Выполнение работы

![Настройка на маршрутизаторе VyOS ](image/28.png){#fig-028 width=70%}

## Выполнение работы

![ПНастройка на маршрутизаторе VyOS](image/29.png){#fig-029 width=70%}

## Выполнение работы

![Настройка на маршрутизаторе VyOS](image/30.png){#fig-030 width=70%}

## Выполнение работы

![Настройка на маршрутизаторе VyOS](image/31.png){#fig-031 width=70%}

## Выполнение работы

Проверили подключение между устройствами подсети с помощью команд ping и trace 

![Отправка эхо-запроса PC1 и PC2](image/32.png){#fig-032 width=60%}

# Выводы

В ходе выполнения лабораторной работы мы изучили принципы распределения и настройки адресного пространства на устройствах сети.
