---
## Front matter
title: "Лабораторная работа №3"
subtitle: "Сетевые технологии"
author: "Андреева Софья Владимировна"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: false # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

 Изучение посредством Wireshark кадров Ethernet, анализ PDU протоколов транспортного и прикладного уровней стека TCP/IP


# Выполнение лабораторной работы

Команда ipconfig без параметров выводит базовую информацию о конфигурации IP для всех активных сетевых адаптеров.

Активные сетевые адаптеры:
1. Адаптер Ethernet Ethernet 2:
Локальный IPv6-адрес канала: fe80::6f0c:e354:78f5:8579%4
Это link-local адрес IPv6, автоматически сгенерированный для коммуникации в пределах локальной сети
%4 указывает на идентификатор зоны (интерфейс)
IPv4-адрес: 192.168.56.1
Частный IP-адрес из диапазона, зарезервированного для сетей класса C
Маска подсети: 255.255.255.0
Определяет, что в сети может быть до 254 узлов (192.168.56.1-192.168.56.254)
Основной шлюз: не указан. Это характерно для адаптеров, используемых в виртуальных средах (например, VirtualBox Host-Only Network)

2. Адаптер беспроводной локальной сети Беспроводная сеть:
Локальный IPv6-адрес канала: fe80::f984:20b8:5632:7cb7%16
Автоматически сгенерированный IPv6 адрес для локальной связи
IPv4-адрес: 172.16.70.152
Частный IP-адрес из диапазона 172.16.0.0-172.31.255.255 (класс B)
Маска подсети: 255.255.254.0
Нестандартная маска, позволяющая использовать 510 адресов в подсети (172.16.70.0-172.16.71.255)
Основной шлюз: 172.16.70.1
Маршрутизатор, через который осуществляется выход в интернет

Три адаптера неактивны - это могут быть виртуальные адаптеры VPN или дополнительные сетевые интерфейсы

![Вывод ipconfig](image/1.png){#fig:001 width=70%}

**Команда ipconfig /all**

Выводит полную информацию о конфигурации всех сетевых адаптеров компьютера. В данном случае отображены следующие адаптеры

![all](image/2.png){#fig:002 width=70%}

На основании вывода команды ipconfig /all определены следующие MAC-адреса сетевых интерфейсов:

1. Адаптер Ethernet Ethernet 2 (VirtualBox Host-Only Ethernet Adapter):

MAC-адрес: 0A-00-27-00-00-04

2. Адаптер беспроводной локальной сети Беспроводная сеть:

MAC-адрес: C4-75-AB-5D-A6-9D

Структура MAC-адреса:
MAC-адрес состоит из 6 байтов (48 битов), представленных в шестнадцатеричной системе:

Первые 3 байта (24 бита): OUI (Organizationally Unique Identifier) - идентификатор производителя

Последние 3 байта (24 бита): Уникальный идентификатор сетевого интерфейса

Анализ конкретных MAC-адресов:
1. Адаптер Ethernet Ethernet 2: 0A-00-27-00-00-04

OUI (производитель): 0A-00-27

Зарегистрирован за Oracle Corporation

Используется для виртуальных адаптеров VirtualBox

Идентификатор интерфейса: 00-00-04

Уникальный номер, назначенный производителем для данного сетевого интерфейса

Анализ типа адреса:

Первый байт: 0A в шестнадцатеричной = 00001010 в двоичной системе

Младший бит первого байта: 0 → Индивидуальный (Unicast) адрес

Второй младший бит: 1 → Локально администрируемый адрес

2. Адаптер беспроводной сети: C4-75-AB-5D-A6-9D

OUI (производитель): C4-75-AB

Зарегистрирован за Microsoft Corporation

Идентификатор интерфейса: 5D-A6-9D

Уникальный номер сетевого адаптера

Анализ типа адреса:

Первый байт: C4 в шестнадцатеричной = 11000100 в двоичной системе

Младший бит первого байта: 0 → Индивидуальный (Unicast) адрес

Второй младший бит: 0 → Глобально администрируемый адрес

**Команда ipconfig /displaydns**

Отображает содержимое DNS-кэша. В данном случае в кэше находятся записи для домена mc.yandex.ru:
A-записи: 87.250.251.119, 87.250.250.119, 77.88.21.119 — IP-адреса серверов Яндекса.
Дополнительные записи: ns1.yandex.ru и ns2.yandex.ru — DNS-серверы Яндекса.
Это означает, что компьютер недавно обращался к сервисам Яндекса, и DNS-записи сохранены в кэше для ускорения последующих запросов.

![displaydns](image/3.png){#fig:003 width=70%}


**Команда ipconfig /showclassid**

Отображает все идентификаторы классов DHCP, разрешенные для указанного сетевого адаптера. В данном случае для адаптера "Беспроводная сеть" обнаружены следующие классы DHCPv4.

1. Default Routing and Remote Access Class

Этот класс предназначен для клиентов удаленного доступа (Remote Access). Используется для маршрутизации и управления удаленным доступом, позволяет применять специальные настройки DHCP для VPN-клиентов и других удаленных подключений

2. Default Network Access Protection Class

Класс для клиентов с ограниченным доступом в рамках технологии Network Access Protection (NAP). NAP - технология безопасности, которая проверяет соответствие клиента политикам безопасности перед предоставлением полного доступа к сети. Клиенты, не прошедшие проверку, получают ограниченный доступ.

3. Default BOOTP Class

Класс для клиентов, использующих протокол BOOTP (Bootstrap Protocol)BOOTP - предшественник DHCP, используется для загрузки бездисковых рабочих станций и сетевых устройств. Современные системы обычно используют DHCP, но поддерживают обратную совместимость.


Наличие этих классов указывает на то, что: Система поддерживает удаленный доступ (VPN и другие технологии Remote Access). Реализованы механизмы безопасности через Network Access Protection. Обеспечена обратная совместимость с устаревшими протоколами (BOOTP).Сетевые политики могут дифференцировать клиентов по типам подключения

![Выполнение работы](image/4.png){#fig:004 width=70%}

# Анализ кадров канального уровня в Wireshark

Запустим Wireshark. Выберем активный на нашем устройстве сетевой интерфейс и убедимся, что начался процесс захвата трафика

![Выполнение работы](image/5.png){#fig:005 width=70%}

На нашем устройстве в консоли определим с помощью команды ipconfig IP-адрес устройства и шлюз по умолчанию

![Выполнение работы](image/6.png){#fig:006 width=70%}

На нашем устройстве в консоли с помощью команды ping пропингуем шлюз по умолчанию

![Выполнение работы](image/7.png){#fig:007 width=70%}

В Wireshark остановим захват трафика. В строке фильтра пропишем фильтр arp or icmp и убедимся, что в списке пакетов отобразились только пакеты ARP или ICMP, в частности пакеты, которые были сгенерированы с помощью команды ping, отправленной с нашего устройства на шлюз по умолчанию.

![Выполнение работы](image/8.png){#fig:008 width=70%}

![Выполнение работы](image/9.png){#fig:009 width=70%}

**Изучим эхо-запрос и эхо-ответ ICMP в программе Wireshark:**

**ICMP эхо-запрос (Echo Request)**

Основные характеристики:

Длина кадра: 74 байта (592 бита)

Тип Ethernet кадра: Ethernet II

Инкапсуляция: Ethernet (1)

MAC-адреса:

Источник (Source): c4:75:ab:5d:a6:9c

Назначение (Destination): 70:18:a7:60:90:42

Анализ MAC-адресов:

Источник: c4:75:ab:5d:a6:9c

OUI: c4:75:ab - Microsoft Corporation

Идентификатор интерфейса: 5d:a6:9c

Тип адреса:

Первый байт c4 = 11000100 в двоичной системе

Младший бит = 0 → Индивидуальный (Unicast)

Второй младший бит = 0 → Глобально администрируемый

Назначение: 70:18:a7:60:90:42

OUI: 70:18:a7 - Cisco Systems

Тип адреса:

Первый байт 70 = 01110000 в двоичной системе

Младший бит = 0 → Индивидуальный (Unicast)

Второй младший бит = 0 → Глобально администрируемый

**ICMP эхо-ответ (Echo Reply)**

Основные характеристики:

Длина кадра: 74 байта (592 бита)

Тип Ethernet кадра: Ethernet II

Инкапсуляция: Ethernet (1)

Протоколы в кадре: eth:ethertype:ip:icmp:data

MAC-адреса:

Источник (Source): 70:18:a7:60:90:42 (Cisco Systems)

Назначение (Destination): c4:75:ab:5d:a6:9c (Microsoft Corporation)

Анализ MAC-адресов:

Источник: 70:18:a7:60:90:42

OUI: 70:18:a7 - Cisco Systems

Идентификатор интерфейса: 60:90:42

Тип адреса: Индивидуальный, глобально администрируемый

Назначение: c4:75:ab:5d:a6:9c

OUI: c4:75:ab - Microsoft Corporation

Тип адреса: Индивидуальный, глобально администрируемый

![Выполнение работы](image/10.png){#fig:010 width=70%}

![Выполнение работы](image/11.png){#fig:011 width=70%}

**Изучим кадры данных протокола ARP.Изучим данные в полях заголовка Ethernet II.**

Тип Ethernet кадра: Все ARP-запросы используют Ethernet II с типом 0x0806

MAC-адресация:

Источник: Всегда индивидуальный Unicast адрес запрашивающего устройства

Назначение: Всегда широковещательный адрес ff:ff:ff:ff:ff:ff

Структура сети:

Сеть использует подсеть 172.16.70.0/23 (маска 255.255.254.0)

Основной шлюз: 172.16.70.1

В сети присутствуют устройства различных производителей (Xiaomi и другие)

Назначение ARP-запросов:

Разрешение IP-адресов в MAC-адреса

Обновление ARP-кэшей устройств

Обнаружение новых устройств в сети

Производители устройств:

Xiaomi: OUI 2c:19:5c

Другие устройства: имеют различные OUI, соответствующие их производителям

Данный трафик характерен для нормально функционирующей Ethernet сети, где устройства активно общаются и разрешают адреса через ARP протокол.

![Выполнение работы](image/12.png){#fig:012 width=70%}

Начнём новый процесс захвата трафика в Wireshark. На нашем устройстве в консоли пропингуем по имени адрес ping www.yandex.com.В Wireshark остановим захват трафика. Изучим запросы и ответы протоколов ARP и ICMP:

Маршрутизация пакетов:

Запрос: Компьютер (172.16.70.152) → Маршрутизатор Cisco → Яндекс (77.88.44.55)

Ответ: Яндекс (77.88.44.55) → Маршрутизатор Cisco → Компьютер (172.16.70.152)

MAC-адресация:

Оба MAC-адреса являются индивидуальными (unicast) и глобально администрируемыми

В локальной сети коммуникация происходит между компьютером и маршрутизатором

NAT преобразование:

Маршрутизатор Cisco выполняет преобразование сетевых адресов (NAT)

Внешний сервер видит запрос от публичного IP маршрутизатора, а не от локального 172.16.70.152

ICMP протокол:

Используется для диагностики сети (ping)

Identifier и Sequence Number позволяют сопоставлять запросы и ответы

32 байта данных используются для проверки целостности передачи

Сетевая инфраструктура:

Локальная сеть: 172.16.70.0/23 (частный диапазон)

Маршрутизатор: Cisco Systems

Конечное устройство: Intel (вероятно, Wi-Fi адаптер)

Внешний сервер: Яндекс (77.88.44.55)

![Выполнение работы](image/13.png){#fig:013 width=70%}

![Выполнение работы](image/14.png){#fig:014 width=70%}

# Анализ протоколов транспортного уровня в Wireshark 

На устройстве в браузере перейдём на сайт, работающий по протоколу HTTP (http://info.cern.ch/) и поперемещаемся по ссылкам и разделам сайта в браузере. В Wireshark в строке фильтра укажите http и проанализируем информацию по протоколу TCP в случае запросов и ответов.

![Выполнение работы](image/15.png){#fig:015 width=70%}

1. Успешность соединения:
 Соединение установлено - трехстороннее рукопожатие завершено

 Данные передаются в обоих направлениях

 Подтверждения работают - Ack числа корректны

 Окно переполнения = 249 - нормальное значение для управления потоком

2. Эффективность передачи:
Клиент отправил 508 байт HTTP запроса

Сервер подтвердил получение и отправил 990 байт ответа

Используется PSH-флаг - ускоренная доставка данных приложению

Keep-alive соединение - возможность повторного использования

3. HTTP транзакция:

КЛИЕНТ (172.16.70.152:38569)          СЕРВЕР (188.184.67.127:80)
     |--- GET /hypertext/www/TheProject.html --->|
     |<--- HTTP Response + данные (990 байт) ----|


4. Общий результат:
TCP соединение между клиентом и сервером info.cern.ch функционирует корректно и эффективно. HTTP запрос успешно доставлен, сервер обработал его и вернул запрашиваемый ресурс. Сетевое соединение демонстрирует надежную доставку данных с правильным управлением потоком и подтверждением получени

![Выполнение работы](image/16.png){#fig:016 width=70%}

В Wireshark в строке фильтра укажем dns и проанализируем информацию по протоколу UDP в случае запросов и ответов

Запрос:
Клиент: 172.16.70.152:61538
DNS сервер: 37.18.92.5:53
Размер запроса: 62 байта - компактный запрос
Ответ:
Размер ответа: 503 байта - близко к лимиту UDP для DNS
Содержит: Обычно A-записи, CNAME, NS записи и другую DNS информацию
DNS over UDP демонстрирует оптимальное использование бессоединенного протокола для службы разрешения имен. Несмотря на отсутствие гарантий доставки на транспортном уровне, механизмы повторения на уровне приложения обеспечивают достаточную надежность при минимальных задержках.

![Выполнение работы](image/17.png){#fig:017 width=70%}

Wireshark в строке фильтра укажем quic и проанализируем информацию по протоколу quic в случае запросов и ответов.

QUIC запрос 

Ethernet II заголовок:
Длина кадра: 74 байта (592 бита)
MAC источника: c4:75:ab:5d:a6:9c - Intel Corporate (компьютер)
MAC назначения: 70:18:a7:60:9c:d2 - Cisco Systems (маршрутизатор)
Тип: 0x0800 - IPv4
IP заголовок:
IP источника: 172.16.70.152 - локальный адрес компьютера
IP назначения: 173.194.73.198 - сервер Google (видно по IP)
UDP заголовок:
Исходный порт: 49664 - эфемерный порт клиента
Порт назначения: 443 - порт для QUIC (аналогично HTTPS)
Длина: 40 байт
Данные: 32 байта QUIC

QUIC ответ

MAC назначения: c4:75:ab:5d:a6:9c - Intel (компьютер)
MAC источника: 70:18:a7:60:9c:d2 - Cisco (маршрутизатор)
Тип адресов: Оба индивидуальные (unicast), глобально администрируемые
IP источника: 173.194.73.198 - сервер Google
IP назначения: 172.16.70.152 - клиент
UDP заголовок:
Источник: Порт 443 (QUIC сервер)
Назначение: Порт 49664 (клиент)
Длина: 33 байта
Данные: QUIC payload

![Выполнение работы](image/18.png){#fig:018 width=70%}

# Анализ handshake протокола TCP в Wireshark

На устройстве используем соединение по HTTP с сайтом CERN для захвата в Wireshark пакетов TCP.В Wireshark проанализируем handshake протокола TCP

ISN сервера: 1066793423 - случайное начальное число
ISN клиента: 3100681904 (вычисляется из Ack: 3100681905 - 1)

1. Корректность handshake:
SYN-ACK корректно сформирован - флаги и номера верны
ISN выбран случайно - защита от предсказуемости
Ack Number = ISNc + 1 - правильное подтверждение SYN

2. Безопасность:
Случайные ISN - предотвращение предсказуемости последовательностей
 Расширенные опции TCP - современные возможности протокола

3. Производительность:
Оптимальный размер заголовка - 32 байта с необходимыми опциями
Подготовка к быстрой передаче - установка параметров окна

4. Сетевые характеристики:
Сервис: CERN через HTTP - зашифрованная коммуникация
Порт 443: Стандартный для защищенных веб-сервисов
Стабильное соединение: Нет признаков проблем с сетью

![Выполнение работы](image/19.png){#fig:019 width=70%}

В Wireshark в меню «Статистика» выберем «График Потока»

Анализ TCP-записей в Wireshark показывает установление и поддержание сетевых соединений между клиентами и серверами. 

**Примеры :**
- `TCP: 22854 – 443 [ACK]` — подтверждение установления соединения с веб-сервером (порт 443)
- `Seq=1 Ack=1 Win=509` — начальные номера последовательностей и размер окна
- `Len=1` — передача 1 байта данных (keep-alive)
- `SLE=1` — использование Selective Acknowledgment
- `TLSv1.2: Application Data` — зашифрованный трафик поверх TCP
- `Win=16385` — увеличенное окно для высокоскоростной передачи TLS-данных

Записи демонстрируют фазы TCP-коммуникации: handshake, передача данных, подтверждения и управление потоком через размеры окон.

![Выполнение работы](image/20.png){#fig:020 width=70%}


# Вывод

В ходе выполнения лабораторной работы мы изучили посредством Wireshark кадров Ethernet, анализ PDU протоколов транспортного и прикладного уровней стека TCP/IP.